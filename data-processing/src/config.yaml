# Production Configuration for Semantic Search System

# =============================================================================
# UNIFIED CATALOG - Single source of truth for all filter/tag values
# Used by: filter extraction, LLM intent context, tag validation
# =============================================================================
catalog:
  # Price ranges for tag suggestions
  price_ranges:
    - Under $50
    - Under $100
    - Under $200
    - Under $500
    - Under $1,000
    - Under $1,500
    - Under $2,000
    - $500-$1,000
    - $1,000-$2,000
    - $2,000-$3,000
    - Over $3,000
  
  colors:
    - Grey
    - Gray
    - Brown
    - White
    - Black
    - Blue
    - Red
    - Green
    - Beige
    - Cream
    - Navy
    - Tan
    - Charcoal
    - Natural
    - Walnut
    - Oak
    - Ivory
    - Taupe
    - Sand
    - Camel
    - Cognac
    - Espresso
    - Slate
    - Olive
    - Mustard
    - Blush
    - Pink
    - Terracotta
    - Rust
  
  materials:
    # Furniture materials
    - Wood
    - Leather
    - Fabric
    - Metal
    - Glass
    - Plastic
    - Rattan
    - Marble
    - Velvet
    - Linen
    - Cotton
    - Walnut
    - Oak
    - Acacia
    - Teak
    - Mango
    - Pine
    - Ash
    - Birch
    - Bamboo
    - Wicker
    - Iron
    - Steel
    - Brass
    - Aluminum
    - Concrete
    - Stone
    - Ceramic
    - Terrazzo
    - Boucl√©
    - Boucle
    - Chenille
    - Microfiber
    - Polyester
    - Performance Fabric
    # Bedding & textile materials
    - Percale
    - Sateen
    - Silk
    - Satin
    - Wool
    - Cashmere
    - Fleece
    - Down
    - Feather
    - Memory Foam
    - Latex
    # Tableware materials
    - Porcelain
    - Stoneware
    - Earthenware
    - Bone China
    - Melamine
    - Acrylic
    - Crystal
    - Borosilicate
    # Rug materials
    - Jute
    - Sisal
    - Seagrass
    - Hemp
    - Viscose
    - Polypropylene
    - Nylon
  
  sizes:
    - Small
    - Medium
    - Large
    - King
    - Queen
    - Single
    - Double
    - Twin
    - Full
    - California King
    - Compact
    - Oversized
    - Petite
    - Extra Large
    - XL
    - 2-Seater
    - 3-Seater
    - 4-Seater
    - 5-Seater
    - 6-Seater
    - Extendable
    - Modular
  
  categories:
    # Living Room
    - Sofa
    - Sectional
    - Armchair
    - Accent Chair
    - Recliner
    - Loveseat
    - Chaise
    - Ottoman
    - Pouf
    - Coffee Table
    - Side Table
    - End Table
    - Console Table
    - TV Unit
    - TV Stand
    - Media Console
    - Bookcase
    - Bookshelf
    - Shelf
    - Shelving
    # Dining Room
    - Dining Table
    - Dining Chair
    - Bar Stool
    - Counter Stool
    - Bench
    - Buffet
    - Sideboard
    - Credenza
    - Bar Cabinet
    - Wine Rack
    # Bedroom
    - Bed
    - Bed Frame
    - Headboard
    - Nightstand
    - Bedside Table
    - Dresser
    - Chest
    - Wardrobe
    - Armoire
    - Vanity
    - Mirror
    # Office
    - Desk
    - Office Chair
    - Filing Cabinet
    - Desk Lamp
    # Outdoor
    - Outdoor Sofa
    - Outdoor Chair
    - Outdoor Table
    - Patio Furniture
    - Lounge Chair
    - Sun Lounger
    - Outdoor Dining
    - Outdoor Cushion
    # Lighting
    - Lamp
    - Floor Lamp
    - Table Lamp
    - Pendant
    - Chandelier
    - Sconce
    - Wall Light
    # Storage
    - Cabinet
    - Storage
    - Organizer
    - Basket
    - Trunk
    - Storage Box
    # Soft Furnishings & Textiles
    - Rug
    - Area Rug
    - Runner
    - Throw
    - Throw Blanket
    - Blanket
    - Pillow
    - Cushion
    - Cushion Cover
    - Pillow Cover
    - Sofa Cover
    - Furniture Cover
    # Bedding & Linens
    - Bedding
    - Bed Linen
    - Sheet
    - Sheet Set
    - Fitted Sheet
    - Flat Sheet
    - Duvet
    - Duvet Cover
    - Quilt
    - Quilt Cover
    - Comforter
    - Pillowcase
    - Pillow Protector
    - Mattress Protector
    - Mattress Topper
    - Bed Throw
    # Tableware & Dining Accessories
    - Tableware
    - Dinnerware
    - Dinner Set
    - Plate
    - Bowl
    - Mug
    - Cup
    - Glassware
    - Drinking Glass
    - Wine Glass
    - Tumbler
    - Carafe
    - Pitcher
    - Cutlery
    - Cutlery Set
    - Flatware
    - Serving Platter
    - Serving Bowl
    - Tray
    - Coaster
    - Placemat
    - Table Linen
    - Napkin
    # Home Decor & Accessories
    - Vase
    - Planter
    - Pot
    - Candle
    - Candle Holder
    - Diffuser
    - Fragrance
    - Clock
    - Wall Clock
    - Photo Frame
    - Picture Frame
    - Wall Art
    - Artwork
    - Sculpture
    - Decorative Object
    - Bookend
    - Decorative Bowl
    # Bathroom Accessories
    - Towel
    - Bath Towel
    - Hand Towel
    - Bath Mat
    - Bathroom Accessory
  
  styles:
    - Modern
    - Contemporary
    - Traditional
    - Minimalist
    - Scandinavian
    - Mid-Century
    - Industrial
    - Rustic
    - Farmhouse
    - Bohemian
    - Boho
    - Coastal
    - Art Deco
    - Transitional
    - Classic
    - Vintage
    - Retro
    - Japandi
    - Wabi-Sabi
    - Eclectic
    - Glam
    - Luxurious
    - Elegant
    - Casual
    - Formal
  
  rooms:
    - Living Room
    - Bedroom
    - Dining Room
    - Kitchen
    - Home Office
    - Office
    - Study
    - Entryway
    - Foyer
    - Hallway
    - Bathroom
    - Outdoor
    - Patio
    - Balcony
    - Backyard
    - Nursery
    - Kids Room
    - Guest Room
    - Master Bedroom
  
  features:
    - Reclining
    - Swivel
    - Adjustable
    - Extendable
    - Convertible
    - Sleeper
    - Storage
    - With Drawers
    - With Shelves
    - Upholstered
    - Tufted
    - Slipcovered
    - Removable Cover
    - Washable
    - Stain Resistant
    - Pet Friendly
    - Kid Friendly
    - Easy Assembly
    - Assembled
    - Stackable
    - Foldable
    - Wheeled
    - With Arms
    - Armless
    - High Back
    - Low Profile
  
  conditions:
    - New
    - Sale
    - Clearance
    - Bestseller
    - Popular
    - Trending
    - New Arrival
    - Limited Edition
    - Exclusive
    - In Stock
    - Quick Ship
    - Ready to Ship

# =============================================================================
# AWS CONFIGURATION
# =============================================================================
aws:
  # Default region for S3 and OpenSearch
  region: ap-southeast-1
  
  # Bedrock uses us-east-1 (Titan models only available there)
  bedrock_region: us-east-1
  
  s3:
    bucket: your-bucket-name  # Replace with your S3 bucket (or set S3_BUCKET_NAME env var)
    data_prefix: data/active_only/
    files:
      - variant.csv
      - variant_image.csv
      - variant_property.csv
      - variant_option.csv
      - variant_affinity.csv
      - variant_file.csv
  
  bedrock:
    text_model_id: amazon.titan-embed-text-v2:0
    text_embedding_dimension: 1024
    image_model_id: amazon.titan-embed-image-v1
    image_embedding_dimension: 1024
    max_retries: 3
    timeout_seconds: 30
  
  opensearch:
    endpoint: https://your-domain.us-east-1.es.amazonaws.com  # Replace with your OpenSearch endpoint
    # Credentials moved to .env file for security
    # username and password are loaded from environment variables
    use_iam_auth: true  # Set to false if using username/password auth
    indices:
      text_index: product-text-embeddings
      image_index: product-image-embeddings
    
search_query:
  max_results: 50
  response_timeout_seconds: 3
  default_search_mode: hybrid  # Options: knn, bm25, hybrid
  
  # Search strategy weights for hybrid mode
  hybrid_weights:
    knn_weight: 0.6
    bm25_weight: 0.4
  
  # Reciprocal Rank Fusion parameters
  rrf:
    k: 60  # RRF constant
  
  # Result scoring
  min_similarity_score: 0.0  # Return all results above this threshold
  
  # Field boosting for BM25
  field_boosts:
    product_name: 3.0
    variant_name: 2.5
    description: 1.5
    categories: 2.0
    properties: 1.0
  
  # Filter extraction (uses unified 'catalog' section for values)
  filters:
    enabled: true
    
    # Price filter patterns (regex patterns for extraction)
    price_patterns:
      # "under $1000", "below $500", "less than $2000"
      - pattern: '(?:under|below|less than|max|up to|at most)\s*\$?\s*(\d+(?:,\d{3})*(?:\.\d{2})?)'
        type: max
      # "over $500", "above $1000", "more than $2000", "at least $500"
      - pattern: '(?:over|above|more than|min|at least|starting at|from)\s*\$?\s*(\d+(?:,\d{3})*(?:\.\d{2})?)'
        type: min
      # "between $500 and $1000", "$500-$1000", "$500 to $1000"
      - pattern: '(?:between\s*)?\$?\s*(\d+(?:,\d{3})*(?:\.\d{2})?)\s*(?:and|-|to)\s*\$?\s*(\d+(?:,\d{3})*(?:\.\d{2})?)'
        type: range
      # "around $1000", "about $500", "approximately $2000"
      - pattern: '(?:around|about|approximately|roughly|near)\s*\$?\s*(\d+(?:,\d{3})*(?:\.\d{2})?)'
        type: approximate
        variance_percent: 20

data_ingestion:
  batch_size: 100
  max_workers: 4
  
embedding_generation:
  batch_size: 25  # Bedrock batch limit
  max_workers: 2
  text_fields:
    - variant_name
    - product_name
    - description
    - aggregated_properties
  
indexing:
  batch_size: 100
  refresh_interval: 1s
  number_of_shards: 2
  number_of_replicas: 1
  
  # KNN settings
  knn:
    method: hnsw
    engine: nmslib
    space_type: l2
    ef_construction: 512
    m: 16

logging:
  level: INFO  # DEBUG, INFO, WARNING, ERROR
  format: json
  cloudwatch:
    enabled: true
    log_group: /aws/semantic-search
    retention_days: 7

monitoring:
  cloudwatch_metrics: true
  metrics:
    - search_latency
    - search_errors
    - embedding_generation_time
    - index_size
    - llm_fallback_count
    - tag_generation_count

# =============================================================================
# LLM FEATURES (use unified 'catalog' section for values)
# =============================================================================

# Feature 5: LLM Fallback for Intent Extraction
llm_fallback:
  enabled: true
  model_id: anthropic.claude-sonnet-4-5-20250929-v1:0
  similarity_threshold: 0.3  # Trigger fallback when top score is below this
  cache_enabled: true
  cache_ttl_seconds: 3600  # 1 hour cache for LLM responses
  max_retries: 2
  timeout_seconds: 30

# Feature 6: Related Search Tags (Google Shopping Style)
related_tags:
  enabled: true
  min_tags: 3
  max_tags: 10
  llm_model_id: anthropic.claude-sonnet-4-5-20250929-v1:0
  cache_enabled: true
  cache_ttl_seconds: 1800  # 30 minutes cache for tags
  
  # Tag types to generate (maps to catalog keys)
  tag_types:
    - categories
    - price_ranges
    - materials
    - styles
    - colors
